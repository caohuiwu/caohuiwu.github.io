---
title: 《Mybatis》相关知识点
date: 2021-03-04
categories:
  - [mybatis]
---

    这是Mybatis系列的第5篇文章，主要介绍的是Mybatis的相关知识点。

<style>
.my-code {
   color: orange;
}
.orange {
   color: rgb(255, 53, 2)
}
.red {
   color: red
}
code {
   color: #0ABF5B;
}
</style>

# 一、Mybatis
`Mybatis`是持久层框架，通过XML或注解配置SQL映射，将Java对象与数据库操作解耦。与传统的JDBC相比，Mybatis简化了数据库交互，并提供了灵活的SQL控制能力。

<!-- more -->


# 二、#{}和 ${}的区别是什么？
- `${}`是字符串替换
- `#{}`是预处理
  - 会对 sql 语句进行预处理，将 sql 中的 `#{}`替换为`?`号，调用 `PreparedStatement` 的 `set` 方法来赋值；
  - `#{}`可以有效的防止 SQL 注入，提高系统安全性。


# 三、缓存
- 一级缓存
  - 在没有配置的默认情况下，它只开启一级缓存，一级缓存只是相对于同一个SqlSession而言
    - 生命周期有多长？
        MyBatis在开启一个数据库会话时，会 创建一个新的SqlSession对象，SqlSession对象中会有一个新的Executor对象。Executor对象中持有一个新的PerpetualCache对象；当会话结束时，SqlSession对象及其内部的Executor对象还有PerpetualCache对象也一并释放掉
        如果SqlSession调用了close()方法，会释放掉一级缓存PerpetualCache对象，一级缓存将不可用。
        如果SqlSession调用了clearCache()，会清空PerpetualCache对象中的数据，但是该对象仍可使用
- 二级缓存
  - 是Application级别的缓存，它可以提高对数据库查询的效率，以提高应用的性能。
  - 范围是按照每个`namespace`缓存来存贮和维护，同一个`namespace`放到一个缓存对象中，当这个`namespace`中执行了！`insert、update和delete`语句的时候，整个namespace中的缓存全部清除掉



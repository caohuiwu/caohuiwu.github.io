<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content=".my-code {    color: orange; } .orange {    color: rgb(255, 53, 2) } .red {    color: red } code {    color: #0ABF5B; }   一、序列化序列化：将数据结构或对象转换成二进制串字节流或其他可存储&#x2F;传输的格式（如JSON、XML等）">
<meta property="og:type" content="article">
<meta property="og:title" content="序列化方式">
<meta property="og:url" content="http://yoursite.com/2021/07/02/2021-07-02-%E5%BA%8F%E5%88%97%E5%8C%96%E6%96%B9%E5%BC%8F/index.html">
<meta property="og:site_name" content="CHW&#39;s Notes">
<meta property="og:description" content=".my-code {    color: orange; } .orange {    color: rgb(255, 53, 2) } .red {    color: red } code {    color: #0ABF5B; }   一、序列化序列化：将数据结构或对象转换成二进制串字节流或其他可存储&#x2F;传输的格式（如JSON、XML等）">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-07-01T16:00:00.000Z">
<meta property="article:modified_time" content="2025-04-16T13:52:44.908Z">
<meta property="article:author" content="chw">
<meta property="article:tag" content="java">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://yoursite.com/2021/07/02/2021-07-02-%E5%BA%8F%E5%88%97%E5%8C%96%E6%96%B9%E5%BC%8F/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>序列化方式 | CHW's Notes</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">CHW's Notes</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/07/02/2021-07-02-%E5%BA%8F%E5%88%97%E5%8C%96%E6%96%B9%E5%BC%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/touxiang.jpg">
      <meta itemprop="name" content="chw">
      <meta itemprop="description" content="do somthing">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CHW's Notes">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          序列化方式
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-07-02 00:00:00" itemprop="dateCreated datePublished" datetime="2021-07-02T00:00:00+08:00">2021-07-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-04-16 21:52:44" itemprop="dateModified" datetime="2025-04-16T21:52:44+08:00">2025-04-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%BA%8F%E5%88%97%E5%8C%96/" itemprop="url" rel="index"><span itemprop="name">序列化</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span><br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>8.2k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>21 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <style>
.my-code {
   color: orange;
}
.orange {
   color: rgb(255, 53, 2)
}
.red {
   color: red
}
code {
   color: #0ABF5B;
}
</style>

<h1 id="一、序列化"><a href="#一、序列化" class="headerlink" title="一、序列化"></a>一、序列化</h1><p><strong>序列化</strong>：将数据结构或对象转换成<strong>二进制串字节流</strong>或其他可存储&#x2F;传输的格式（如JSON、XML等）</p>
<span id="more"></span>

<blockquote>
<p><code class="red">二进制串在Java里面所指的是byte[]</code></p>
</blockquote>
<h2 id="1-1、核心目的"><a href="#1-1、核心目的" class="headerlink" title="1.1、核心目的"></a>1.1、核心目的</h2><ul>
<li><strong>持久化存储</strong>：将对象保存到文件、数据库或磁盘中。</li>
<li><strong>网络传输</strong>：通过网络（如HTTP、TCP）将数据发送到其他系统或设备。</li>
<li><strong>跨平台通信</strong>：不同编程语言或系统间的数据交换（如Java对象传给Python程序）</li>
</ul>
<h1 id="二、IDL（Interface-description-language）"><a href="#二、IDL（Interface-description-language）" class="headerlink" title="二、IDL（Interface description language）"></a>二、IDL（Interface description language）</h1><p>接口描述语言（<code>IDL</code>），采用<code>IDL</code>撰写的协议约定称之为<code>IDL</code>文件</p>
<ul>
<li>语言、平台无关</li>
<li><code>IDL</code>的目的是撰写<code>IDL</code>文件，而<code>IDL</code>文件被<code>IDL Compiler</code>编译后能够产生一些代码（<code>Stub/Skeleton</code>）</li>
</ul>
<h1 id="三、序列化方式"><a href="#三、序列化方式" class="headerlink" title="三、序列化方式"></a>三、序列化方式</h1><h2 id="3-1、XML"><a href="#3-1、XML" class="headerlink" title="3.1、XML"></a>3.1、XML</h2><ul>
<li>本质上是一种描述语言，并且具有自我描述（<code>Self-describing</code>）的属性，所以XML自身就被用于XML序列化的<code>IDL</code></li>
<li>空间和时间开销都比较大，对于对性能要求在ms级别的服务，不推荐使用</li>
</ul>
<h2 id="3-2、JSON"><a href="#3-2、JSON" class="headerlink" title="3.2、JSON"></a>3.2、JSON</h2><h3 id="3-2-1、优点"><a href="#3-2-1、优点" class="headerlink" title="3.2.1、优点"></a>3.2.1、优点</h3><ul>
<li>可读性高</li>
<li><code>XML</code>所产生序列化之后文件的大小接近<code>JSON</code>的两倍</li>
<li>具备<code>Javascript</code>的先天性支持，所以被广泛应用于<code>Web browser</code>的应用常景中，是<code>Ajax</code>的事实标准协议</li>
<li>与XML相比，其协议比较简单，解析速度比较快</li>
<li>具有良好的可扩展性和兼容性</li>
</ul>
<h3 id="3-2-2、应用场景"><a href="#3-2-2、应用场景" class="headerlink" title="3.2.2、应用场景"></a>3.2.2、应用场景</h3><ul>
<li>公司之间传输数据量相对小，实时性要求相对低（例如秒级别）的服务</li>
<li>基于Web browser的Ajax请求</li>
</ul>
<p>不适合场景：</p>
<ul>
<li>采用JSON进行序列化的额外空间开销比较大，对于大数据量服务或持久化，这意味着巨大的内存和磁盘开销，这种场景不适合</li>
<li>在性能要求为ms级别，不建议使用</li>
<li>JSON实在是太简单了，或者说太像各种语言里面的类了，所以采用JSON进行序列化不需要IDL(没有IDL，意思是没有统一的描述语言)</li>
</ul>
<h2 id="3-3、Thrift"><a href="#3-3、Thrift" class="headerlink" title="3.3、Thrift"></a>3.3、Thrift</h2><p>Thrift有两层含义</p>
<ul>
<li>apache thrift：跨语言RPC框架，Thrift是Facebook开源提供的一个高性能，轻量级RPC服务框架</li>
</ul>
<p>示例如下：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">struct Address</span><br><span class="line">&#123;</span><br><span class="line">1: required string city;</span><br><span class="line">2: optional string postcode;</span><br><span class="line">3: optional string street;</span><br><span class="line">&#125;</span><br><span class="line">struct UserInfo</span><br><span class="line">&#123;</span><br><span class="line">1: required string userid;</span><br><span class="line">2: required i32 name;</span><br><span class="line">3: optional list</span><br><span class="line"> address;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-3-1、技术架构"><a href="#3-3-1、技术架构" class="headerlink" title="3.3.1、技术架构"></a>3.3.1、技术架构</h3><h4 id="3-3-1-1、IDL（接口定义语言）"><a href="#3-3-1-1、IDL（接口定义语言）" class="headerlink" title="3.3.1.1、IDL（接口定义语言）"></a>3.3.1.1、IDL（接口定义语言）</h4><ul>
<li>定义数据类型（如结构体、枚举）和服务接口</li>
<li>示例<figure class="highlight thrift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义一个结构体</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="number">1</span>: <span class="type">i32</span> id,</span><br><span class="line">    <span class="number">2</span>: <span class="type">string</span> name,</span><br><span class="line">    <span class="number">3</span>: <span class="type">bool</span> active = <span class="literal">true</span>  <span class="comment">// 默认值</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义服务接口</span></span><br><span class="line"><span class="class"><span class="keyword">service</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    User getUser(<span class="number">1</span>: <span class="type">i32</span> userId) throws (<span class="number">1</span>: UserNotFoundException error),</span><br><span class="line">    <span class="keyword">void</span> createUser(<span class="number">1</span>: User user)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<strong>支持数据类型</strong></li>
<li><strong>基本类型</strong></li>
<li><strong>结构体类型</strong>：<ul>
<li><code>struct</code>: 定义的结构体对象</li>
</ul>
</li>
<li><strong>容器类型</strong>：<ul>
<li><code>list</code>: 有序元素列表</li>
</ul>
</li>
<li><strong>异常类型</strong>：<ul>
<li><code>exception</code>: 异常类型</li>
</ul>
</li>
<li><strong>服务类型</strong>：<ul>
<li><code>service</code>: 具体对应服务的类</li>
</ul>
</li>
</ul>
<p><strong>限定修饰符</strong></p>
<ul>
<li><strong>Required</strong>: 表示是一个必须字段</li>
<li><strong>Optional</strong>：表示是一个可选字段</li>
</ul>
<h4 id="3-3-1-2、协议"><a href="#3-3-1-2、协议" class="headerlink" title="3.3.1.2、协议"></a>3.3.1.2、协议</h4><ul>
<li><code>二进制协议</code>：高效紧凑，适合高性能场景。</li>
<li><code>JSON协议</code>：可读性强，适合调试。</li>
<li><code>Compact protocol</code>：压缩格式，体积比二进制更小。</li>
</ul>
<h4 id="3-3-1-3、传输层（Transport）"><a href="#3-3-1-3、传输层（Transport）" class="headerlink" title="3.3.1.3、传输层（Transport）"></a>3.3.1.3、传输层（Transport）</h4><ul>
<li>支持TCP、HTTP、内存传输，灵活适配不同通信场景。</li>
</ul>
<blockquote>
<p>由于Thrift的序列化被嵌入到Thrift框架里面，Thrift框架本身并没有透出序列化和反序列化接口，这导致其很难和其他传输层协议共同使用（例如HTTP）<br>Thrift的序列化和框架紧耦合，无法支持向持久层直接读写数据，所以不适合做数据持久化序列化协议</p>
</blockquote>
<h2 id="3-4、Protobuf"><a href="#3-4、Protobuf" class="headerlink" title="3.4、Protobuf"></a>3.4、Protobuf</h2><p><code>Protocol buffers</code>（简称<code>Protobuf</code>）是由Google开发的序列化框架，用于结构化数据的序列化和跨语言通信。与thrift类似，但设计理念和功能有所不同。</p>
<h3 id="3-4-1、定义数据结构"><a href="#3-4-1、定义数据结构" class="headerlink" title="3.4.1、定义数据结构"></a>3.4.1、定义数据结构</h3><p>通过<code>Protocol buffers</code>定义语言（<code>.proto</code>文件）定义数据结构</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// 示例：定义一个 User 结构体</span><br><span class="line">syntax = &quot;proto3&quot;;  // 指定 proto 版本</span><br><span class="line">package example;</span><br><span class="line"></span><br><span class="line">message User &#123;</span><br><span class="line">    int32 id = 1;          // 必须字段</span><br><span class="line">    string name = 2;       // 必须字段</span><br><span class="line">    bool active = 3;       // 可选字段（proto3 中默认不设置则为 false）</span><br><span class="line">    repeated string emails = 4;  // 数组类型</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>message</code>字段定义说明：</p>
<table>
<thead>
<tr>
<th>optional</th>
<th>unit64</th>
<th>id</th>
<th>&#x3D; 3</th>
<th>[defalut &#x3D; MALE];</th>
</tr>
</thead>
<tbody><tr>
<td>字段规则</td>
<td>字段类型</td>
<td>字段名称</td>
<td>字段唯一标识符</td>
<td>可选的选项：默认值</td>
</tr>
</tbody></table>
<blockquote>
<p>字段规则<br><code>required</code>：必须包含该字段一次<br><code>optional</code>：包含该字段零次或一次<br><code>repeated</code>：该字段可以重复任意多次，生成的代码是一个列表</p>
</blockquote>
<h3 id="3-4-2、自动生成代码"><a href="#3-4-2、自动生成代码" class="headerlink" title="3.4.2、自动生成代码"></a>3.4.2、自动生成代码</h3><p>通过<code>protoc</code>编译器将<code>.proto</code>文件生成目标语言代码（如<code>Java、Python、C++</code>等），包含序列化&#x2F;反序列化逻辑。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">protoc --java_out=./src user.proto  <span class="comment"># 生成 Java 代码</span></span><br><span class="line">protoc --python_out=./src user.proto  <span class="comment"># 生成 Python 代码</span></span><br></pre></td></tr></table></figure>

<p>生成的Java代码内容</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 包名对应 .proto 中的 package</span></span><br><span class="line"><span class="keyword">package</span> example;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="comment">// 字段对应的 getter/setter 方法</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getId</span><span class="params">()</span> &#123; <span class="keyword">return</span> id_; &#125;</span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">setId</span><span class="params">(<span class="type">int</span> value)</span> &#123; id_ = value; <span class="keyword">return</span> <span class="built_in">this</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123; <span class="keyword">return</span> name_; &#125;</span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">setName</span><span class="params">(String value)</span> &#123; name_ = value; <span class="keyword">return</span> <span class="built_in">this</span>; &#125;</span><br><span class="line">    <span class="comment">// emails 是一个列表</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">getEmailsList</span><span class="params">()</span> &#123; <span class="keyword">return</span> emails_; &#125;</span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">addEmails</span><span class="params">(String value)</span> &#123; emails_.add(value); <span class="keyword">return</span> <span class="built_in">this</span>; &#125;</span><br><span class="line">    <span class="comment">// 序列化方法</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">byte</span>[] toByteArray() <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="keyword">return</span> getDescriptor().newMessageMarshaller(<span class="built_in">this</span>).toByteArray(<span class="built_in">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 反序列化方法</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> User <span class="title function_">parseFrom</span><span class="params">(<span class="type">byte</span>[] data)</span> <span class="keyword">throws</span> InvalidProtocolBufferException &#123;</span><br><span class="line">        <span class="keyword">return</span> getDescriptor().newMessageBuilder().mergeFrom(data).build().getElement();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如何使用生成的Java代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> example.User;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">// 创建 User 对象</span></span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> User.newBuilder()</span><br><span class="line">            .setId(<span class="number">123</span>)</span><br><span class="line">            .setName(<span class="string">&quot;Alice&quot;</span>)</span><br><span class="line">            .addEmails(<span class="string">&quot;alice@example.com&quot;</span>)</span><br><span class="line">            .build();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 序列化为字节数组</span></span><br><span class="line">        <span class="type">byte</span>[] data = user.toByteArray();</span><br><span class="line">        System.out.println(<span class="string">&quot;Serialized size: &quot;</span> + data.length + <span class="string">&quot; bytes&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h3 id="3-4-3、序列化协议"><a href="#3-4-3、序列化协议" class="headerlink" title="3.4.3、序列化协议"></a>3.4.3、序列化协议</h3><p><code>protobuf</code>主要支持二进制协议，通过<code>Varint</code>编码压缩数据，体积小且高效。例如</p>
<ul>
<li><strong>整数编码</strong>：使用<code>Varint</code>（可变长度编码）压缩数值（如<code>7</code>用1个字节存储，<code>1000</code>用2字节）。</li>
<li><strong>结构体编码</strong>：字段ID与值的组合（如字段<code>id=1</code>的值<code>123</code>编码为<code>08 7b</code>)</li>
</ul>
<p>对于下面的数据，用<code>JSON</code>需要<code>103bytes</code>，而<code>Protocol Buffers</code>只需要<code>50bytes</code>。</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;id&quot;:9223372036854775807,&quot;username&quot;:&quot;edgar&quot;,&quot;mobile&quot;:&quot;13412345678&quot;,&quot;mail&quot;:&quot;edgar@github.com&quot;,&quot;age&quot;:30&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3-5、Hessian"><a href="#3-5、Hessian" class="headerlink" title="3.5、Hessian"></a>3.5、Hessian</h2><p>Hessian是一个轻量级的远程过程调用（RPC）协议，基于HTTP实现，提供类似RMI（remote Method Invocation）的功能。使用二进制协议进行数据序列化，适合跨语言通信和传输二进制数据。</p>
<h3 id="3-5-1、工作原理"><a href="#3-5-1、工作原理" class="headerlink" title="3.5.1、工作原理"></a>3.5.1、工作原理</h3><ul>
<li>必须实现<code>Serializable</code>接口</li>
<li>无需 <code>serialVersionUID</code></li>
</ul>
<p>定义可序列化的类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 构造函数、getter/setter 方法</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">(String name, <span class="type">int</span> age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ... getters and setters</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>序列化对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.caucho.hessian.io.Hessian2Output;</span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayOutputStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HessianSerializer</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">// 1. 创建对象</span></span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;张三&quot;</span>, <span class="number">25</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2. 初始化输出流</span></span><br><span class="line">        <span class="type">ByteArrayOutputStream</span> <span class="variable">byteArrayOutputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">        <span class="type">Hessian2Output</span> <span class="variable">hessian2Output</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Hessian2Output</span>(byteArrayOutputStream);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3. 序列化对象</span></span><br><span class="line">        hessian2Output.writeObject(user);</span><br><span class="line">        hessian2Output.close();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 4. 获取字节数组</span></span><br><span class="line">        <span class="type">byte</span>[] serializedData = byteArrayOutputStream.toByteArray();</span><br><span class="line">        System.out.println(<span class="string">&quot;Serialized size: &quot;</span> + serializedData.length + <span class="string">&quot; bytes&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h3 id="3-5-2、序列化的内部机制"><a href="#3-5-2、序列化的内部机制" class="headerlink" title="3.5.2、序列化的内部机制"></a>3.5.2、序列化的内部机制</h3><p>数据编码规则</p>
<ul>
<li><strong>基本类型优化</strong> ：Hessian对常用类型进行编码优化，例如：<ul>
<li><code>int/short/byte</code>编码为’I’</li>
<li><code>long</code> -&gt; “L”</li>
<li><code>float/double</code> -&gt; ‘D’</li>
<li><code>String</code> -&gt; ‘S’ + UTF-8字符串</li>
<li><code>boolean</code> -&gt; ‘T’（真） 或 ‘F’（假）</li>
</ul>
</li>
<li><strong>复杂对象处理</strong>：hessian将对象的属性转换为 Map结构，例如：<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M className=Person propertyName=name I 123 propertyName=age S &quot;Alice&quot;</span><br></pre></td></tr></table></figure>
这种方式允许自描述，但可能导致<strong>父类与子类同名字段覆盖</strong>（父类字段会覆盖子类字段）</li>
</ul>
<h4 id="1-整数（int）"><a href="#1-整数（int）" class="headerlink" title="1. 整数（int）"></a>1. 整数（int）</h4><ul>
<li>编码规则：<br>使用’I’标记表示<code>int/short/byte</code>类型，后续紧跟4字节的整数值（大端序）</li>
<li>示例：序列化 <code>int value = 100;</code><br>二进制字节： <code>0x49 0x00 0x00 0x00 64</code><br>（<code>0x49</code>对应ASCII字符’I’，后跟 <code>0x00 0x00 0x00 64</code> 表示十进制100）</li>
</ul>
<h4 id="2-长整形（long）"><a href="#2-长整形（long）" class="headerlink" title="2. 长整形（long）"></a>2. 长整形（long）</h4><ul>
<li>编码规则：<br>使用’L’标记，后续紧跟8字节的长整数值（大端序）</li>
<li>示例：序列化<code>long value = 123456789L</code><br>二进制字节: <code>0x4C 0x00 0x07 0x5B 0xC9 0x00 0x00 0x00 0x00</code><br>（<code>0x4C</code>对应’L’，后跟 <code>0x00 0x07 0x5B 0xC9 0x00 0x00 0x00 0x00</code> 表示123456789）</li>
</ul>
<h4 id="3-简单对象（如User类）"><a href="#3-简单对象（如User类）" class="headerlink" title="3. 简单对象（如User类）"></a>3. 简单对象（如User类）</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">    <span class="comment">// 构造函数、getter/setter</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>序列化<code>User(&quot;Alice&quot;, 30);</code></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">73 00 0F 63 6F 6D 2E 65 78 61 6D 70 6C 65 2E 55 73 65 72  // 类名：com.example.User</span><br><span class="line">74 00 05 41 6C 69 63 65                                  // name字段值：&quot;Alice&quot;（字符串）</span><br><span class="line">69 00 00 00 1E                                          // age字段值：30（int类型）</span><br></pre></td></tr></table></figure>
<ol>
<li><strong>类名字段</strong></li>
</ol>
<ul>
<li>类型标识符：0x73</li>
<li>类名内容：<ul>
<li>00 0F -&gt; 类名长度为15（十六进制 0F 对应十进制15）</li>
<li>63 6F 6D 2E 65 78 61 6D 70 6C 65 2E 55 73 65 72 -&gt; UTF-8编码的com.example.User<ul>
<li>63 &#x3D; ‘c’, 6F &#x3D; ‘o’, 6D &#x3D; ‘m’, 2E &#x3D; ‘.’, 65 &#x3D; ‘e’, 78 &#x3D; ‘x’, 61 &#x3D; ‘a’, 6D &#x3D; ‘m’, 70 &#x3D; ‘p’, 6C &#x3D; ‘l’, 65 &#x3D; ‘e’, 2E &#x3D; ‘.’, 55 &#x3D; ‘U’, 73 &#x3D; ‘s’, 65 &#x3D; ‘e’, 72 &#x3D; ‘r’。</li>
</ul>
</li>
</ul>
</li>
</ul>
<ol start="2">
<li>字段值序列化</li>
</ol>
<ul>
<li>name 字段（字符串类型）<ul>
<li>类型标识符：0x74（对应字符 ‘t’），表示字符串类型。</li>
<li>字符串内容：<ul>
<li>00 05 → 字符串长度为 5（”Alice”）。</li>
<li>41 6C 69 63 65 → UTF-8编码的 “Alice”：</li>
<li>41 &#x3D; ‘A’, 6C &#x3D; ‘l’, 69 &#x3D; ‘i’, 63 &#x3D; ‘c’, 65 &#x3D; ‘e’。</li>
</ul>
</li>
</ul>
</li>
<li>age 字段（整数类型）<ul>
<li>类型标识符：0x69（对应字符 ‘i’），表示 int 类型。</li>
<li>整数值：<ul>
<li>00 00 00 1E → 四字节大端序表示的 30（0x1E &#x3D; 30）。</li>
</ul>
</li>
</ul>
</li>
</ul>
<blockquote>
<p>相较于Protobuf和Thrift，由于Hessian不需要通过IDL来定义数据和服务，对于序列化的数据只需要实现Serializable接口即可，所以使用上相比Protobuf和Thrift更加容易</p>
</blockquote>
<h2 id="3-6、JDK序列化"><a href="#3-6、JDK序列化" class="headerlink" title="3.6、JDK序列化"></a>3.6、JDK序列化</h2><p>JDK序列化二进制的整体结构，由以下部分组成</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[流头] + [对象图] + [结束标记]</span><br></pre></td></tr></table></figure>

<h3 id="3-6-1、流头（stream-header）"><a href="#3-6-1、流头（stream-header）" class="headerlink" title="3.6.1、流头（stream header）"></a>3.6.1、流头（stream header）</h3><p>固定字节：</p>
<ul>
<li>魔数数字：<code>0xAC ED</code>  （2字节）</li>
<li>版本号：<code>0x00 05</code> （2字节，表示Java5或更高版本）</li>
<li>示例：<code>AC ED 00 05</code></li>
</ul>
<h3 id="3-6-2、对象图（Object-Graph）"><a href="#3-6-2、对象图（Object-Graph）" class="headerlink" title="3.6.2、对象图（Object Graph）"></a>3.6.2、对象图（Object Graph）</h3><h4 id="3-6-2-1、类描述符（class-Descriptor）"><a href="#3-6-2-1、类描述符（class-Descriptor）" class="headerlink" title="3.6.2.1、类描述符（class Descriptor）"></a>3.6.2.1、类描述符（class Descriptor）</h4><ul>
<li>类型标识符：<code>0x73</code> 表示类描述符的开始</li>
<li>类名：使用UTF-8编码的类全限定名（如 <code>Ljava/lang/String</code>）。</li>
<li>序列化<code>VersionUID</code></li>
<li>字段列表</li>
</ul>
<p>示例：序列化User类的类描述符二进制片段</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">73 00 0A 4C 6A 61 76 61 2F 6C 61 6E 67 2F 55 73 65 72  // 类名：java/lang/User</span><br><span class="line">00 00 00 01 72 00 03 6E 61 6D 4C 00 03 61 67 65 74  // 字段名：name, age</span><br></pre></td></tr></table></figure>

<h4 id="3-6-2-2、对象数据（Object-Data）"><a href="#3-6-2-2、对象数据（Object-Data）" class="headerlink" title="3.6.2.2、对象数据（Object Data）"></a>3.6.2.2、对象数据（Object Data）</h4><ul>
<li>对象头：标识对象的开始和类型<ul>
<li>非代理对象：<code>0x73</code></li>
<li>代理对象：<code>0x71</code></li>
</ul>
</li>
<li>字段值：按字段顺序存储，类型由类描述符决定<ul>
<li>基本类型：直接二进制形式存储</li>
<li>对象引用：存储句柄表索引（如0x70后跟4字节索引）</li>
<li>字符串：用0x73标记后跟UTF-8编码的字符串</li>
</ul>
</li>
</ul>
<p>示例：序列化<code>User(&quot;Alice&quot;, 30)</code>的字段数据</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">72 00 03 6E 61 6D 74 00 05 41 6C 69 63 65  // 字段name的值：&quot;Alice&quot;</span><br><span class="line">74 00 00 00 1E  // 字段age的值：30（int）</span><br></pre></td></tr></table></figure>

<h3 id="3-6-3、结束标识"><a href="#3-6-3、结束标识" class="headerlink" title="3.6.3、结束标识"></a>3.6.3、结束标识</h3><p><code>0x77</code>表示序列化结束。</p>
<h3 id="具体示例"><a href="#具体示例" class="headerlink" title="具体示例"></a>具体示例</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">User</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">    <span class="comment">// 构造函数、getter/setter</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>序列化后的二进制字节（十六进制表示）</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AC ED 00 05 73 72 00 04 55 73 65 72 12 E2 A0 A4 F7 81 89 60 89 67 02 00 02 4C 00 03 61 67 65 74 00 03 4E 61 6D 65 00 04 00 00 00 02 74 00 05 41 6C 69 63 65 74 00 1E</span><br></pre></td></tr></table></figure>
<ol>
<li><strong>流头</strong></li>
</ol>
<ul>
<li>AC ED 00 05：魔术数字和版本号</li>
</ul>
<ol start="2">
<li><strong>类描述符</strong></li>
</ol>
<ul>
<li>73：类描述符开始</li>
<li>72 00 04 55 73 65 72：类名User<ul>
<li>0x72：字符串长度</li>
<li>0x04：长度</li>
<li>55 73 65 72：User的UTF-8编码</li>
</ul>
</li>
<li>12 E2 A0 A4 F7 81 89 60 89 67： serialVersionUID</li>
</ul>
<ol start="3">
<li><strong>字段数据</strong>：</li>
</ol>
<ul>
<li>74 00 05 41 6C 69 63 65：字符串Alice<ul>
<li>0x74：标记字符串</li>
<li>0x05：长度5</li>
<li>41 6C 69 63 65：是Alice</li>
</ul>
</li>
<li>74 00 1E：整数30（0x1E是十六进制的30）</li>
</ul>
<h2 id="3-7、JDK-Hessian对比"><a href="#3-7、JDK-Hessian对比" class="headerlink" title="3.7、JDK &amp; Hessian对比"></a>3.7、JDK &amp; Hessian对比</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">User</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>User(“Alice”, 30)</p>
<p>JDK</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AC ED 00 05 73 72 00 04 55 73 65 72 12 E2 A0 A4 F7 81 89 60 89 67 02 00 02 4C 00 03 61 67 65 4C 00 04 6E 61 6D 65 54 00 12 4C 6A 61 76 61 2F 6C 61 6E 67 2F 53 74 72 69 6E 67 56 00 02 00 02 78 70 00 00 00 1E 74 00 05 41 6C 69 63 65 78 00</span><br></pre></td></tr></table></figure>
<p>Hessian</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">73 00 0F 63 6F 6D 2E 65 78 61 6D 70 6C 65 2E 55 73 65 72  // 类名：com.example.User</span><br><span class="line">74 00 05 41 6C 69 63 65                                  // name字段值：&quot;Alice&quot;</span><br><span class="line">69 00 00 00 1E                                          // age字段值：30（int类型）</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>序列化方式</th>
<th>二进制体积</th>
<th>体积差异原因</th>
</tr>
</thead>
<tbody><tr>
<td>JDK</td>
<td>约50字节（示例）</td>
<td>包含类描述符、元数据（如serialVersionUID)、继承关系等冗余信息</td>
</tr>
<tr>
<td>Hessian</td>
<td>约27字节（示例）</td>
<td>仅传输类名和字段值，无冗余元数据，类型标识符更紧凑</td>
</tr>
</tbody></table>

    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/06/20/2021-06-20-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/" rel="prev" title="负载均衡">
      <i class="fa fa-chevron-left"></i> 负载均衡
    </a></div>
      <div class="post-nav-item">
    <a href="/2021/07/23/2021-07-23-%E9%99%90%E6%B5%81-%E7%86%94%E6%96%AD-%E9%99%8D%E7%BA%A7/" rel="next" title="限流-熔断-降级">
      限流-熔断-降级 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E5%BA%8F%E5%88%97%E5%8C%96"><span class="nav-text">一、序列化</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-1%E3%80%81%E6%A0%B8%E5%BF%83%E7%9B%AE%E7%9A%84"><span class="nav-text">1.1、核心目的</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%8C%E3%80%81IDL%EF%BC%88Interface-description-language%EF%BC%89"><span class="nav-text">二、IDL（Interface description language）</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%89%E3%80%81%E5%BA%8F%E5%88%97%E5%8C%96%E6%96%B9%E5%BC%8F"><span class="nav-text">三、序列化方式</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#3-1%E3%80%81XML"><span class="nav-text">3.1、XML</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-2%E3%80%81JSON"><span class="nav-text">3.2、JSON</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-1%E3%80%81%E4%BC%98%E7%82%B9"><span class="nav-text">3.2.1、优点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-2%E3%80%81%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="nav-text">3.2.2、应用场景</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-3%E3%80%81Thrift"><span class="nav-text">3.3、Thrift</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-1%E3%80%81%E6%8A%80%E6%9C%AF%E6%9E%B6%E6%9E%84"><span class="nav-text">3.3.1、技术架构</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-1-1%E3%80%81IDL%EF%BC%88%E6%8E%A5%E5%8F%A3%E5%AE%9A%E4%B9%89%E8%AF%AD%E8%A8%80%EF%BC%89"><span class="nav-text">3.3.1.1、IDL（接口定义语言）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-1-2%E3%80%81%E5%8D%8F%E8%AE%AE"><span class="nav-text">3.3.1.2、协议</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-1-3%E3%80%81%E4%BC%A0%E8%BE%93%E5%B1%82%EF%BC%88Transport%EF%BC%89"><span class="nav-text">3.3.1.3、传输层（Transport）</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-4%E3%80%81Protobuf"><span class="nav-text">3.4、Protobuf</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-1%E3%80%81%E5%AE%9A%E4%B9%89%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="nav-text">3.4.1、定义数据结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-2%E3%80%81%E8%87%AA%E5%8A%A8%E7%94%9F%E6%88%90%E4%BB%A3%E7%A0%81"><span class="nav-text">3.4.2、自动生成代码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-3%E3%80%81%E5%BA%8F%E5%88%97%E5%8C%96%E5%8D%8F%E8%AE%AE"><span class="nav-text">3.4.3、序列化协议</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-5%E3%80%81Hessian"><span class="nav-text">3.5、Hessian</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-5-1%E3%80%81%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="nav-text">3.5.1、工作原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-5-2%E3%80%81%E5%BA%8F%E5%88%97%E5%8C%96%E7%9A%84%E5%86%85%E9%83%A8%E6%9C%BA%E5%88%B6"><span class="nav-text">3.5.2、序列化的内部机制</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E6%95%B4%E6%95%B0%EF%BC%88int%EF%BC%89"><span class="nav-text">1. 整数（int）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E9%95%BF%E6%95%B4%E5%BD%A2%EF%BC%88long%EF%BC%89"><span class="nav-text">2. 长整形（long）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E7%AE%80%E5%8D%95%E5%AF%B9%E8%B1%A1%EF%BC%88%E5%A6%82User%E7%B1%BB%EF%BC%89"><span class="nav-text">3. 简单对象（如User类）</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-6%E3%80%81JDK%E5%BA%8F%E5%88%97%E5%8C%96"><span class="nav-text">3.6、JDK序列化</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-6-1%E3%80%81%E6%B5%81%E5%A4%B4%EF%BC%88stream-header%EF%BC%89"><span class="nav-text">3.6.1、流头（stream header）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-6-2%E3%80%81%E5%AF%B9%E8%B1%A1%E5%9B%BE%EF%BC%88Object-Graph%EF%BC%89"><span class="nav-text">3.6.2、对象图（Object Graph）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-6-2-1%E3%80%81%E7%B1%BB%E6%8F%8F%E8%BF%B0%E7%AC%A6%EF%BC%88class-Descriptor%EF%BC%89"><span class="nav-text">3.6.2.1、类描述符（class Descriptor）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-6-2-2%E3%80%81%E5%AF%B9%E8%B1%A1%E6%95%B0%E6%8D%AE%EF%BC%88Object-Data%EF%BC%89"><span class="nav-text">3.6.2.2、对象数据（Object Data）</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-6-3%E3%80%81%E7%BB%93%E6%9D%9F%E6%A0%87%E8%AF%86"><span class="nav-text">3.6.3、结束标识</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B7%E4%BD%93%E7%A4%BA%E4%BE%8B"><span class="nav-text">具体示例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-7%E3%80%81JDK-Hessian%E5%AF%B9%E6%AF%94"><span class="nav-text">3.7、JDK &amp; Hessian对比</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="chw"
      src="/images/touxiang.jpg">
  <p class="site-author-name" itemprop="name">chw</p>
  <div class="site-description" itemprop="description">do somthing</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">196</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">142</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">25</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">chw</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
